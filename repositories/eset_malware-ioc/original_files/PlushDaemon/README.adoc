= China-aligned PlushDaemon compromises supply chain of Korean VPN service  â€“- Indicators of Compromise

The blog post about PlushDaemon is available on WeLiveSecurity at
https://www.welivesecurity.com/en/eset-research/plushdaemon-compromises-supply-chain-korean-vpn-service/

== Files

The following samples are unencrypted on disk.

[options="header"]
|===
|SHA-1 |Filename |ESET detection name|Description
|`068FD2D209C0BBB0C6FC14E88D63F92441163233` |`IPanyVPNsetup.exe` |Win32/Agent.AEIJ |Trojanized IPany installer. Contains the SlowStepper implant and the legitimate IPany software.
|`2DB60F0ADEF14F4AB3573F8309E6FB135F67ED7D` |`lregdll.dll` |Win32/Agent.AGUU |Loader DLL for the SlowStepper backdoor.
|`AD4F0428FC9290791D550EEDDF171AFF046C4C2C` |`svcghost.exe` |Win32/Agent.AGUU |Process monitor component that launches PerfWatson.exe or RuntimeSvc.exe to side-load lregdll.dll.
|===

The following samples are extracted in memory from .pkg and (fake) .gif files.

[options="header"]
|===
|SHA-1 |Filename |ESET detection name|Description
|`401571851A7CF71783A4CB902DB81084F0A97F85` |`main.dll` |Win32/Agent.AEIJ |Decrypted SlowStepper backdoor component.
|`846C025F696DA1F6808B9101757C005109F3CF3D` |`OldLJM.dll` |Win32/Agent.AGXL |Installer DLL, internally named OldLJM.dll. It is extracted from EncMgr.pkg and executed in memory.
|===

The following samples are tools. By default, these tools are not encrypted.

[options="header"]
|===
|SHA-1 |Filename |ESET detection name|Description
|`5A79AEA546B04292C099137AF4740A944F02963A` |`getcode.mod` |Win32/RiskWare.Mimikatz.E |Mimikatz tool (32-bit version).
|`6B6E16C6E4E5301BE715642179B8E19E91F777A4` |`getcode64.mod` |Win64/Riskware.Mimikatz.CV |Mimikatz tool (64-bit version).
|`B5A5DA09114F1E8443DAF13A799F2645C135B0BC` |`stoll.mod` |WinGo/TrojanDownloader.Agent.KJ |Downloader tool.
|`EEDA5D66285FF8E0BAAB8621994BF1D365188721` |`Remote.mod` |Win32/Agent.AGXO |RealVNC server tool.
|`C58D6AC9D0B2D4E1144490CCDE581D9C34CBB38E` |`soc.mod` |WinGo/Agent.AFQ |Custom reverse proxy tool.
|`D22B0DB144C1B42B1CE2A1741C83D845092FCC61` |`InitPython.mod` |Win32/Agent.AGXN |Tool used to deploy a customized Python distribution.
|`00385604A792B8874238E9B0ABC98A423135B2F4` |`demo.mod` |Win32/Agent.AGXM |A DLL tool to test the correct execution of DLL files and their exported functions
|`D1EB4427BDB7F59A01FDA60811708F07308F7987` |`test.mod` |Win32/Agent.AGXM |An executable tool to test the execution of executable files and console output.
|`3C36574E7683A2C6382DC55345B7D1D544C1C1EF` |`agent.mod` |WinGo/Agent.AFP |Custom reverse proxy tool.
|===

The following samples are part of the SlowStepper toolkit.

[options="header"]
|===
|SHA-1 |Filename |ESET detection name|Description
|`B5B5AB0074F81C02F27D263BC3723809BE0D86A8` |`win7py.org` |Python/Agent.ASZ |Python distribution containing 
SlowStepper toolkit.
|`4B194770F6054C513B5A3821CB94FEEA58C09D3C` |`winpy_no_rundll.org` |Python/Agent.ASZ |Python distribution containing SlowStepper toolkit.
|`0FA9C4958FBD8513A41056938D5FBCE6C63BBE03` |`winxppy.org` |Python/Agent.ASZ |Python distribution containing SlowStepper toolkit.
|`5977A9538627BF274C438FD04A6E20E1A5BA3A4A` |`help.pyd` |Win32/Agent.AGXP |Module that decrypts and executes Python modules in the toolkit used by SlowStepper.
|`EEB4A930EF2D4547B96F06AC6783B06E215C2F13` |`runas.py` |Generik.BPJYOAI |Script used by SlowStepper to execute malicious Python modules from its toolkit.
|===

== Network Indicators

[options="header"]
|===
|IP address        |Domain |Details
|`202.189.8[.]72` |`reverse.wcsset[.]com`|Server used by the (reverse proxy) soc.mod tool.
|`47.96.17[.]237` |`agt.wcsset[.]com`|Server used by agent.mod tool.
||`7051.gsm.360safe[.]company`|SlowStepper queries this domain to obtain its associated DNS TXT record.
|`202.105.1[.]187` |`st.360safe[.]company`|Fallback C&C server contacted by SlowStepper.
|`47.74.159[.]166` ||SlowStepper C&C server.
|`8.130.87[.]195` ||SlowStepper C&C server.
|`47.108.162[.]218` ||SlowStepper C&C server.
|`47.113.200[.]18` ||SlowStepper C&C server.
|`47.104.138[.]190` ||SlowStepper C&C server.
|`120.24.193[.]58` ||SlowStepper C&C server.
|`202.189.8[.]87` ||SlowStepper C&C server.
|`202.189.8[.]69` ||SlowStepper C&C server.
|`202.189.8[.]193` ||SlowStepper C&C server.
|`47.92.6[.]64` ||SlowStepper C&C server.
|===

== URLs

----
https://gitcode[.]net/LetMeGo22/caffe/raw/master/models/bvlc_mod
https://gitcode[.]net/LetMeGo22/caffe/raw/master/models/finetune_flickr_to_python/glib
https://gitcode[.]net/LetMeGo22/caffe/raw/master/models/finetune_flickr_to_python/tmod
http://zuoye.free[.]fr/files/stoll.rar
----
