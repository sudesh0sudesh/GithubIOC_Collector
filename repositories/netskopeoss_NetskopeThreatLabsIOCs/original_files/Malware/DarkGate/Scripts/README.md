### Script

Netskope Threat Labs is releasing a small script to automate the final DarkGate payload extraction from the obfuscated .bin files within the MSI file.

The example bellow will deobfuscate the files in the "samples" directory, write those into the "samples_output" directory and print a verbose output to the user showing the target file hashes and XOR key used to deobfuscate the files:

```shell
python3 extract_darkgate_payload.py -p samples -o samples_output -v

[+] MD5: 69f900118f985990f488121cd1cf5e2b
[+] XOR key: vJDAbKIz

[+] MD5: f90e30df61aec134fba71d66a87326c1
[+] XOR key: ELkMtLfA

[+] MD5: 377d8d910f7d6747727ca413967d6395
[+] XOR key: RmDbBDsf 
```

If no default output path is provided the script creates a dir names "out" and writes the clean payloads there.