2024-10-08 (TUESDAY): FAKE CLOCKIFY SITE PUSHES BOTH WINDOWS AND MAC MALWARE

AUTHOR:

- Bradley Duncan

REFERENCES:

- https://www.linkedin.com/posts/unit42_lummastealer-macosmalware-timelythreatintel-activity-7249791739572428800-DXeo/
- https://x.com/Unit42_Intel/status/1844026121504882932

NOTES:

- The name of this file has a typo with 11 (Nov) for the month, when it should be 10 (Oct): 2024-11-08-IOCs-for-malware-from-fake-Clockify-site.txt

- As early as Tuesday 2024-10-08, we found a malicious Google ad that led to a fake Clockify site pushing malware.
- The fake Clockify site offered two downloads, one for Windows and one for Mac.

- The Mac download was a 704 kB disk image (DMG) file that changed file hash, name and size across different downloads.
- These DMG files contain a Macho-O executable designed to run on macOS for either Intel or Apple CPUs.
- The Mach-O exectutable did not install Clockify, but it did copy and exfiltrate data from a lab host.
- In macOS, potential victims must click their way through a series of warnings and enter their password for an infection.

- The Windows download was a 115.7 MB executable file that was the same across different downloads.
- The Windows executable file contains a 116.5 MB MSI installer for Clockify and other files to install Lumma Stealer.
- The Windows infection chain retrieves and extracts Lumma Stealer from a password-protected RAR file.

URL FOR GOOGLE AD SEEN ON 2024-10-08 LEADING TO FAKE CLOCKIFY SITE:

- hxxps[:]//www.googleadservices[.]com/pagead/aclk?sa=L&
  ai=DChcSEwi9xo6fxf-IAxU7d38AHeJwJfMYABACGgJvYQ&
  co=1&
  ase=2&
  gclid=EAIaIQobChMIvcaOn8X_iAMVO3d_AB3icCXzEAMYASAAEgJxePD_BwE&
  ohost=www.google[.]com&
  cid=CAASJeRoV6LSIHpp1WLd1_kTgaec73QOiPLIn5qcAVmDLf1DNHt3lRE&
  sig=AOD64_3p704Z27UZGzgeMAIMdOIGkifbFw&
  q&
  nis=4&
  adurl&
  ved=2ahUKEwir6Imfxf-IAxVgMtAFHSatBpcQ0Qx6BAgUEAE

FAKE CLOCKIFY SITE:

- hxxps[:]//www-clockify[.]me/

URLS FROM FAKE CLOCKIFY SITE TO DOWNLOAD MALWARE:

- For Windows: hxxps[:]//www-clockify[.]me/Clockify(3.02).exe
- For macOS: hxxps[:]//apunanwu[.]com/kusaka.php?call=clockify

================================================================
MAC INFECTION CHAIN:

- Google ad --> Fake Clockify site --> DMG download --> victim installs Mach-O executable --> data exfiltration to C2 server

THREE EXAMPLES OF DOWNLOADED DMG FILES:

- c34d93400a47b4fbaa39586467aae94c23d5c2a16929e03836e184c0819b98f9 - 704,604 bytes - ClockifyDesktop_v3.67.dmg
- c8bc08c9792c853ce913b2ea0ce87b67ae8ffec7ea92c248fdbf33959184f3ae - 704,535 bytes - ClockifyDesktop_v5.74.dmg
- c4392b06441a0826933e8a7cc36d29b5b42a94ec6d37cd35039e92dddc67c7a8 - 704,630 bytes - ClockifyDesktop_v7.28.dmg

EXTRACTED MACH-O EXECUTABLES FROM THE ABOVE THREE DMG FILES:

- 1505254870f2561ddda8f73be9147023469b27a543eb39551439c46fbae9b976 - 201,824 bytes - ClockifyDesktop
- adcb5c3d4f777b01655cfa0c4be4a9d3ad1345a94f5e1cdab50fdb052e7b3769 - 201,824 bytes - ClockifyDesktop
- 2212040d4afc5e1fb2a499f48c17f92253f5f6f9863989f9181e99ba5dcff1cb - 201,824 bytes - ClockifyDesktop

FILE TYPE OF THE MACH-O EXECUTABLES:

- Mach-O universal binary with 2 architectures: [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64]

POST-INFECTION DATA EXFILTRATION TO C2 SERVER:

- 85.209.11[.]155 port 80 - 85.209.11[.]155 - POST /joinsystem

================================================================
WINDOWS INFECTION CHAIN:

- Google ad --> Fake Clockify site --> trojanized Clockify installer --> installs Lumma Stealer --> data exfiltration to C2 server

DOWNLOADED TROJANIZED CLOCKIFY INSTALLER:

- SHA256 hash: 9842c0a49ea0cd22ca91f78b2cedd35ffe12bab7dbdcdb4c20cc16af50a02b3c
- File size: 115,704,152 bytes
- File name: Clockify(3.02).exe
- File type: PE32+ executable (GUI) x86-64, for MS Windows

FILES FOR LUMMA STEALER:

- SHA256 hash: 3ac8630aba1a0315bc77816b4ffaaaeb061d033d33e1aa4db70c1c1ad9471fe7
- File size: 9,885,622 bytes
- File location: hxxp[:]//193.3.168[.]112/forra.rar
- File type: RAR archive data, v5
- File description: Password-protected RAR archive containing Windows EXE for Lumma Stealer
- Password: Qwerty1234.Q
- Note: This file is not malicious without the password

- SHA256 hash: d723f7bb031b36dbd5ab0f3d9bb7b995569dea439edfbe66a9f8999c1a0ce562
- File size: 10,542,108 bytes
- File name: forra.exe
- File type: PE32 executable (GUI) Intel 80386, for MS Windows
- File description: Windows EXE for Lumma Stealer

TRAFFIC TO RETRIEVE RAR UNARCHIVER AND PASSWORD-PROTECTED RAR FILE CONTAINING LUMMA STEALER:

- hxxp[:]//193.3.168[.]112/UnRAR.exe
- hxxp[:]//193.3.168[.]112/forra.rar

DNS QUERIES FOR LUMMA STEALER C2 DOMAINS THAT DID NOT RESOLVE:

- assaultxnh[.]site
- bathdoomgaz[.]store
- clearancek[.]site
- dissapoiznw[.]store
- eaglepawnoy[.]store
- licendfilteo[.]site
- mobbipenju[.]store
- spirittunek[.]store
- studennotediw[.]store

LUMMA STEALER C2 TRAFFIC:

- hxxps[:]//steamcommunity[.]com/profiles/76561199724331900   <-- not inherently malicious on its own
- hxxps[:]//sergei-esenin[.]com/api   <-- HTTP POST requests for data exfiltration
