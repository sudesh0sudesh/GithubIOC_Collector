# NoaBot detection logic and IoCs

This repository contains a detection script that looks for artifacts of the NoaBot botnet.  
It looks for the malware's persistence service, paths and other relics.  
Below, you can also find OsQuery queries that detect some of the malware's artifacts.

This repository also includes an IoC csv file, a YARA rule to detect the cryptominer and also the credential lists that the botnet uses in its SSH dictionary attacks.
  
The full report about NoaBot can be found in our [blogpost](https://akamai.com/blog/security-research/mirai-based-noabot-crypto-mining).  

-----------------------
## Osquery
We're also including Osquery queries that can be run to look for malware IoCs.  

### Malware files and process
`SELECT path FROM file WHERE path LIKE '/lib/%/magicPussy%' OR path LIKE '/lib/%/mimic_%' OR path LIKE '/lib/%/ScBr_%' OR path = '/tmp/linux';`  
`SELECT name, cmdline, pid FROM processes WHERE name LIKE 'magicPussy%' OR name LIKE 'mimic_%' OR name LIKE 'ScBr_%' OR name = 'linux';`  

### Persistence
`SELECT * FROM crontab WHERE command LIKE '/lib/%/magicPussy%' OR command LIKE '/lib/%/mimic_%' OR command LIKE '/lib/%/ScBr_%' OR command LIKE '/tmp/linux';`    

### Backdoor
`SELECT * FROM authorized_keys WHERE key LIKE '%AAAAB3NzaC1yc2EAAAADAQABAAABgQDtlkWJzOwt6Erl3lDRq+QUSop854X/tC9BcU0bBk+5qLvPAU/FIsQmIPGjW5xNauKGiX/wSYvxuZpmnM6s400YEOlmqIxr13QChFK1aovjNUypK5upgjUHyPp98rP3CBtj7Zjwr3RICOzCFYdrTKEjy8QW/1dO8OjCr34UKq5zfoCkh3T7OtVmDzKkbvGilHYpLeJcSoaFqBQYzyfeRb4FFSY660WLBc33UVdjzjV2LqM7RfR5W6M5+QPuPrKze7x0hQwnRaNEIGBJVBVx3gribIo1t18zEcbpUiWp1yQzCl8ShyhtkyIb8wkEfwrULDaQWNAOHHq+fEC/4sI31A7+MT45m/U3NpQflvmzZhbbNsIQdPhnw7tlDK71n/ifcWZPwmgCFWi58DnFWfEX6SZp36RulActSclpqcUx1WxvnHZ25zMei5Q+cSoNWY2XWiRm0Pcub4VKDGT4Ram8zYJCABU23TaITgew4kt6Q4zEMCKe5kOJA3xYgNgPGhyX9fk=%' OR key LIKE '%rainbow@mommy%';`  
